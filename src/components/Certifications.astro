---
import { useTranslations } from '../i18n/utils';
import { certifications } from '../data/certifications';

export interface Props {
  lang: 'pt' | 'en';
}

const { lang } = Astro.props;
const t = useTranslations(lang);

// Sort certifications by date (newest first)
const sortedCertifications = certifications.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

// Format date
const formatDate = (dateString: string) => {
  const date = new Date(dateString);
  return date.toLocaleDateString(lang === 'pt' ? 'pt-BR' : 'en-US', {
    year: 'numeric',
    month: 'short'
  });
};

// Get icon component for certification
const getIcon = (iconType?: string) => {
  switch (iconType) {
    case 'graduation':
      return `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"></path>
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path>
      </svg>`;
    case 'aws':
      return `<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
        <path d="M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576a.8.8 0 01.08.32c0 .128-.048.24-.144.336l-.48.32c-.064.048-.128.064-.192.064a.365.365 0 01-.208-.08 2.488 2.488 0 01-.24-.304 5.82 5.82 0 01-.208-.384c-.528.624-1.188.936-1.98.936-.565 0-1.016-.16-1.351-.48-.336-.32-.504-.752-.504-1.296 0-.576.208-1.04.624-1.392.416-.353.968-.528 1.656-.528.23 0 .472.016.727.048.254.032.516.08.783.144v-.48c0-.496-.104-.843-.312-1.04-.207-.198-.56-.296-1.057-.296-.227 0-.463.027-.708.08a5.031 5.031 0 00-.724.208.515.515 0 01-.144.032c-.048 0-.096-.016-.144-.048a.374.374 0 01-.096-.112l-.144-.464c-.032-.08-.016-.144.048-.192a2.58 2.58 0 01.688-.256c.272-.064.57-.096.893-.096.68 0 1.179.16 1.498.48.318.32.478.8.478 1.44v1.888zm-2.735 1.024c.22 0 .448-.04.683-.12.235-.08.442-.22.622-.42.108-.12.188-.25.24-.39.052-.14.08-.304.08-.488v-.464a6.259 6.259 0 00-.624-.112 5.19 5.19 0 00-.624-.048c-.44 0-.764.088-.97.264-.207.176-.311.424-.311.744 0 .304.08.533.239.688.16.155.384.232.665.232v.016zm5.39 1.376c-.08 0-.133-.016-.16-.048-.027-.032-.048-.096-.063-.192L8.19 4.972c-.016-.096-.024-.16-.024-.192 0-.128.064-.192.191-.192h.781c.08 0 .134.016.161.048.026.032.047.096.062.192l.894 7.024.832-7.024c.016-.096.036-.16.062-.192.027-.032.082-.048.161-.048h.637c.08 0 .135.016.161.048.027.032.047.096.063.192l.838 7.104.92-7.104c.016-.096.036-.16.062-.192.027-.032.082-.048.161-.048h.741c.128 0 .191.064.191.192 0 .032-.008.096-.024.192l-1.006 7.224c-.016.096-.037.16-.063.192-.027.032-.081.048-.16.048h-.685c-.08 0-.134-.016-.16-.048-.027-.032-.047-.096-.063-.192L11.197 5.68l-.822 6.952c-.016.096-.036.16-.062.192-.027.032-.081.048-.161.048h-.684zm8.316.112c-.027 0-.048-.008-.063-.016-.016-.008-.032-.024-.048-.048l-.543-.704c-.016-.032-.024-.064-.024-.096 0-.048.016-.08.048-.096.327-.272.598-.62.814-1.044.215-.424.323-.888.323-1.392 0-.816-.216-1.448-.647-1.896-.431-.448-1.031-.672-1.799-.672-.367 0-.718.064-1.055.192a4.55 4.55 0 00-.918.528c-.016.016-.032.024-.048.024-.032 0-.048-.016-.048-.048v-.747c0-.048.008-.08.024-.096a.374.374 0 01.08-.048c.336-.176.718-.32 1.146-.432.428-.112.86-.168 1.298-.168.972 0 1.738.272 2.299.816.56.544.84 1.328.84 2.352 0 .72-.144 1.376-.432 1.968-.287.592-.703 1.08-1.246 1.464-.016.016-.032.024-.048.024z"/>
      </svg>`;
    case 'coursera':
      return `<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
        <path d="M11.374 23.977c-1.016-.068-2.362-.263-2.833-.41-.175-.055-.284-.055-.284 0 0 .1.468.263 1.026.356.558.093 2.017.226 3.2.29 1.183.063 3.063.052 4.178-.025 1.115-.077 2.423-.263 2.908-.413.485-.15.883-.422.883-.604 0-.182-.398-.454-.883-.604-.485-.15-1.793-.336-2.908-.413-1.115-.077-2.995-.088-4.178-.025zm.14-2.782c-1.715-.263-3.65-.263-4.305 0-.655.263-.326.658 1.16.658 1.486 0 3.421-.132 4.305-.395.884-.263.555-.526-1.16-.263zm9.263-2.782c-.175-.055-.284-.055-.284 0 0 .1.468.263 1.026.356.558.093 2.017.226 3.2.29 1.183.063 3.063.052 4.178-.025 1.115-.077 2.423-.263 2.908-.413.485-.15.883-.422.883-.604 0-.182-.398-.454-.883-.604z"/>
      </svg>`;
    case 'ibm':
      return `<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
        <path d="M13.438 1.5H6.562v21h6.876V1.5zM22.5 7.875H15.75v8.25H22.5v-8.25zM1.5 7.875v8.25h6.75v-8.25H1.5z"/>
      </svg>`;
    default:
      return `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
      </svg>`;
  }
};
---

<section id="certifications" class="py-20 bg-white dark:bg-gray-900">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 dark:text-white mb-4">
        {t('certifications.title')}
      </h2>
      <p class="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
        {lang === 'pt' 
          ? 'Formação acadêmica e certificações profissionais que fundamentam minha expertise técnica.'
          : 'Academic background and professional certifications that ground my technical expertise.'
        }
      </p>
      <div class="w-20 h-1 bg-blue-600 mx-auto mt-6"></div>
    </div>
    
    <!-- Timeline -->
    <div class="max-w-4xl mx-auto">
      <div class="relative">
        <!-- Timeline line -->
        <div class="absolute left-8 top-0 bottom-0 w-0.5 bg-blue-200 dark:bg-blue-800"></div>
        
        <!-- Timeline items -->
        <div class="space-y-8">
          {sortedCertifications.map((cert, index) => (
            <div class="relative flex items-start group">
              <!-- Timeline dot -->
              <div class="absolute left-6 w-4 h-4 bg-blue-600 rounded-full border-4 border-white dark:border-gray-900 group-hover:bg-blue-700 transition-colors z-10"></div>
              
              <!-- Content -->
              <div class="ml-16 flex-1">
                <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600">
                  <div class="flex items-start justify-between">
                    <div class="flex-1">
                      <!-- Title and Icon -->
                      <div class="flex items-center mb-2">
                        <div class="text-blue-600 dark:text-blue-400 mr-3" set:html={getIcon(cert.icon)} />
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                          {cert.title[lang]}
                        </h3>
                      </div>
                      
                      <!-- Issuer -->
                      <p class="text-gray-600 dark:text-gray-400 mb-2">
                        {cert.issuer}
                      </p>
                      
                      <!-- Date -->
                      <p class="text-sm text-gray-500 dark:text-gray-500">
                        {formatDate(cert.date)}
                      </p>
                      
                      <!-- Credential ID -->
                      {cert.credentialId && (
                        <p class="text-xs text-gray-400 dark:text-gray-500 mt-2">
                          ID: {cert.credentialId}
                        </p>
                      )}
                    </div>
                    
                    <!-- View Credential Button -->
                    {cert.url && (
                      <a
                        href={cert.url}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="inline-flex items-center px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors"
                        title={t('certifications.viewCredential')}
                      >
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                        </svg>
                        {lang === 'pt' ? 'Ver' : 'View'}
                      </a>
                    )}
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
    
    <!-- Stats -->
    <div class="mt-16 text-center">
      <div class="inline-flex items-center px-6 py-3 bg-blue-50 dark:bg-blue-900/20 rounded-full">
        <svg class="w-5 h-5 text-blue-600 dark:text-blue-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
        </svg>
        <span class="text-blue-800 dark:text-blue-200 font-medium">
          {sortedCertifications.length} {lang === 'pt' ? 'Certificações Obtidas' : 'Certifications Earned'}
        </span>
      </div>
    </div>
  </div>
</section>